<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Calculadora de Reboque</title>
    <!-- O CSS do usu√°rio foi movido para o bloco <style> -->
    <style>
        /* Reset b√°sico */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f0f4f8;
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding: 20px;
        }

        .container {
            background: white;
            max-width: 600px;
            width: 100%;
            padding: 30px 40px;
            border-radius: 12px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }

        .section {
            margin-bottom: 30px;
        }

        .section h2 {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: #444;
            border-bottom: 2px solid #1a73e8;
            padding-bottom: 5px;
        }

        /* Formul√°rio */
        .form-group {
            display: flex;
            flex-direction: column;
            margin-bottom: 15px;
        }

        label {
            margin-bottom: 6px;
            font-weight: 600;
            color: #555;
            user-select: none;
        }

        input[type="text"],
        input[type="number"],
        select {
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
            outline-offset: 0;
        }

        input[type="text"]:focus,
        input[type="number"]:focus,
        select:focus {
            border-color: #1a73e8;
            outline: none;
            box-shadow: 0 0 5px rgba(26, 115, 232, 0.5);
        }

        /* Bot√£o */
        button {
            cursor: pointer;
            background: #1a73e8;
            color: white;
            border: none;
            padding: 14px 25px;
            font-size: 1.1rem;
            border-radius: 10px;
            font-weight: 700;
            width: 100%;
            transition: background-color 0.3s ease;
            user-select: none;
            margin-top: 5px;
        }

        button:hover,
        button:focus {
            background: #155ab6;
            outline: none;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap; /* Garante responsividade */
        }

        .button-group button {
            flex: 1; /* Distribui o espa√ßo entre os bot√µes */
            min-width: 150px; /* Garante que os bot√µes n√£o fiquem pequenos demais */
            margin-top: 0;
        }
        
        .button-buscar {
            /* Mantido para compatibilidade, mas agora usa .button-group */
        }

        #resultado {
            font-weight: 700;
            white-space: pre-line;
            font-size: 1.1rem;
            padding: 15px 20px;
            background: #e1f0ff;
            border-radius: 8px;
            border: 1px solid #7ab8ff;
            min-height: 60px;
            color: #0d47a1;
        }
        
        #mensagem-erro {
            color: red; 
            margin-bottom: 10px; 
            padding: 10px; 
            border: 1px solid red; 
            background-color: #ffe0e0;
            border-radius: 8px;
        }

        /* Responsividade */
        @media (max-width: 480px) {
            .container {
                padding: 20px;
            }
            .button-group button {
                flex-basis: 100%;
            }

            input[type="text"],
            input[type="number"],
            select,
            button {
                font-size: 1rem;
                padding: 10px 12px;
            }
        }

        .whatsapp-button {
            background-color: #25D366; /* Cor verde do WhatsApp */
            color: white;
            border: none;
            padding: 14px 25px;
            font-size: 1.1rem;
            border-radius: 10px;
            font-weight: 700;
            width: 100%;
            margin-top: 15px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            user-select: none;
        }

        .whatsapp-button:hover,
        .whatsapp-button:focus {
            background-color: #128C7E;
            outline: none;
        }

        #detalhes-moto {
            margin-top: 15px;
            padding: 15px;
            border: 1px solid #eee;
            border-radius: 8px;
            background-color: #f9f9f9;
        }

        #detalhes-moto .form-group {
            margin-bottom: 10px;
        }

        .number-label {
            width: 100%; 
        }
        
        .endereco-section .form-group:nth-child(2) input[type="number"], 
        .destino-section .form-group:nth-child(2) input[type="number"] {
            width: 100%;
        }

        .footer {
            text-align: center;
            padding: 20px 10px;
            font-size: 0.95rem;
            color: #777;
            border-top: 1px solid #ddd;
            margin-top: 40px;
            background-color: #f9f9f9;
            border-radius: 0 0 12px 12px;
        }

        .footer strong {
            color: #1a73e8;
        }
        .logo-placeholder {
            text-align: center;
            font-size: 2rem;
            font-weight: bold;
            color: #1a73e8;
            margin-bottom: 20px;
        }
    </style>
    <script>
        // Configura√ß√µes e Fun√ß√µes do JS
        const API_KEY = "5b3ce3597851110001cf62489e24024317f24032483d474b971a0694"; 
        const enderecoBase = "R. Dom Jo√£o VI, 6 - Santa Cruz, Rio de Janeiro - RJ";
        const WHATSAPP_NUMBER = "5521999999999"; 

        // --- FUN√á√ïES DE ROBUSTEZ DE REDE ---
        
        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        async function retryFetch(url, options = {}, maxRetries = 3) {
            for (let i = 0; i < maxRetries; i++) {
                try {
                    const response = await fetch(url, options);
                    
                    if (response.ok) {
                        return response;
                    }
                    
                    if (i === maxRetries - 1) {
                        throw new Error(`Falha na requisi√ß√£o ap√≥s ${maxRetries} tentativas. Status: ${response.status} ${response.statusText}`);
                    }

                } catch (error) {
                    console.error(`Tentativa ${i + 1} falhou (Erro de Rede/Conex√£o):`, error.message);
                    if (i === maxRetries - 1) {
                        throw new Error("Falha na requisi√ß√£o de rede ap√≥s m√∫ltiplas tentativas. Verifique sua conex√£o ou tente novamente mais tarde.");
                    }
                }
                
                const delay = Math.pow(2, i) * 1000; 
                console.log(`Aguardando ${delay / 1000}s antes de tentar novamente...`);
                await sleep(delay);
            }
        }
        // -------------------------------------
        
        function applyJitter(coords) {
            const [lon, lat] = coords;
            return [lon, lat + 0.000001]; 
        }

        async function buscarEnderecoPorCEP(cep, numero) {
            limparMensagemErro(); 

            // 1. Busca no ViaCEP (com retry)
            const response = await retryFetch(`https://viacep.com.br/ws/${cep}/json/`);
            
            const data = await response.json();
            if (data.erro) throw new Error("CEP n√£o encontrado.");

            const enderecoCompleto = `${data.logradouro}, ${numero} - ${data.bairro}, ${data.localidade} - ${data.uf}`;
            
            // 2. Valida geocodifica√ß√£o (com retry no Geocode interno)
            const valido = await validarEndereco(enderecoCompleto);
            if (!valido) throw new Error("Endere√ßo inv√°lido ou fora do Brasil (apenas Brasil √© suportado).");
            
            return enderecoCompleto;
        }

        async function validarEndereco(enderecoCompleto) {
            try {
                const coords = await geocode(enderecoCompleto);
                if (!coords) return false;
                const [lon, lat] = coords;
                
                // Valida√ß√£o de latitude/longitude para o Brasil (relaxada).
                return lat <= 7 && lat >= -36 && lon >= -76 && lon <= -33;
            } catch (e) {
                console.error("Falha na valida√ß√£o do geocode:", e.message);
                return false;
            }
        }

        /**
         * Realiza Geocodifica√ß√£o (Texto -> Coordenadas)
         */
        async function geocode(endereco) {
            const url = `https://api.openrouteservice.org/geocode/search?api_key=${API_KEY}&text=${encodeURIComponent(endereco)}`;
            
            const response = await retryFetch(url);

            const data = await response.json();
            if (!data.features?.length) throw new Error("Endere√ßo n√£o encontrado.");

            const coords = data.features[0].geometry?.coordinates;
            if (!coords || coords.length !== 2) throw new Error("Coordenadas inv√°lidas.");
            return coords; // [lon, lat]
        }
        
        /**
         * Realiza Geocodifica√ß√£o Reversa (Coordenadas -> Texto)
         * @param {number} lat Latitude.
         * @param {number} lon Longitude.
         * @returns {Promise<string>} Endere√ßo completo em texto.
         */
        async function reverseGeocode(lat, lon) {
            const url = `https://api.openrouteservice.org/geocode/reverse?api_key=${API_KEY}&point.lon=${lon}&point.lat=${lat}`;
            
            const response = await retryFetch(url);

            const data = await response.json();
            
            if (!data.features?.length) throw new Error("Endere√ßo n√£o encontrado nas coordenadas.");

            // Pega o endere√ßo mais prov√°vel (primeira feature)
            const properties = data.features[0].properties;
            
            // Tenta montar um endere√ßo completo e limpo
            const addressParts = [
                properties.housenumber,
                properties.street,
                properties.postalcode,
                properties.locality,
                properties.region
            ].filter(p => p).join(', ');

            if (!addressParts) throw new Error("N√£o foi poss√≠vel formatar o endere√ßo.");

            return addressParts;
        }

        async function rota(pontoA, pontoB) {
            if (!Array.isArray(pontoA) || !Array.isArray(pontoB)) throw new Error("Coordenadas inv√°lidas.");

            const body = { coordinates: [pontoA, pontoB] };
            const profile = "driving-car"; 
            const url = `https://api.openrouteservice.org/v2/directions/${profile}`;

            const options = {
                method: "POST",
                headers: { Authorization: API_KEY, "Content-Type": "application/json" },
                body: JSON.stringify(body),
            };

            const response = await retryFetch(url, options);

            const data = await response.json();
            const distancia = data?.routes?.[0]?.summary?.distance;
            
            if (!distancia || isNaN(distancia)) {
                const erroNaResposta = data.error?.message || "Estrutura de resposta inesperada ou rota n√£o encontrada.";
                console.error(`[DEBUG COORDS] Falha na rota entre: ${JSON.stringify(pontoA)} e ${JSON.stringify(pontoB)}`);
                throw new Error(`Erro rota: Rota n√£o encontrada. Tente endere√ßos mais precisos ou diferentes. Detalhe: ${erroNaResposta}`);
            }

            return distancia / 1000; // km
        }
        
        async function safeRota(pontoA, pontoB, isJittered) {
            const MIN_SAFE_DISTANCE_KM = 0.2; 
            
            try {
                const distance = await rota(pontoA, pontoB);
                
                if (isJittered && distance < 0.001) { 
                    console.warn("Dist√¢ncia calculada foi zero/quase zero mesmo com Jitter. Aplicando fallback.");
                    return { distance: MIN_SAFE_DISTANCE_KM, fallback: true };
                }
                
                return { distance, fallback: false };
            } catch (error) {
                console.warn(`[DEBUG] Rota falhou. Aplicando fallback para evitar travamento. Erro: ${error.message}`);
                return { distance: MIN_SAFE_DISTANCE_KM, fallback: true };
            }
        }


        let valorTotal = 0;
        
        const coordsString = (coords) => `[Lon: ${coords[0].toFixed(5)}, Lat: ${coords[1].toFixed(5)}]`;


        async function calcular() {
            limparMensagemErro(); 
            
            let enderecoOrigemCompleto;
            let enderecoDestinoCompleto;
            let tipoVeiculo;
            let cilindrada = 0; 
            let coordOrigem;

            try {
                document.getElementById("resultado").innerText = "Calculando...";
                
                tipoVeiculo = document.getElementById("tipo").value;
                if (!tipoVeiculo) throw new Error("Selecione o tipo de ve√≠culo.");

                enderecoOrigemCompleto = document.getElementById("origem").value; 
                enderecoDestinoCompleto = document.getElementById("destino").value; 

                if (!enderecoOrigemCompleto) throw new Error("Defina o endere√ßo de Origem (CEP ou Localiza√ß√£o Atual).");
                if (!enderecoDestinoCompleto) throw new Error("Busque o endere√ßo de Destino primeiro.");

                if (tipoVeiculo === "15") {
                    cilindrada = parseInt(document.getElementById("cilindrada-moto").value);
                    if (isNaN(cilindrada)) throw new Error("Informe a cilindrada da moto.");
                }
                
                // --- 1. Determinar Coordenadas de Origem ---
                const savedLon = parseFloat(document.getElementById("coord-origem-lon").value);
                const savedLat = parseFloat(document.getElementById("coord-origem-lat").value);
                
                if (!isNaN(savedLon) && !isNaN(savedLat)) {
                    // ORIGEM VEIO DA GEOLOCALIZA√á√ÉO
                    coordOrigem = [savedLon, savedLat];
                    console.log("[COORD SOURCE] Origem obtida via Geolocation.");
                } else {
                    // ORIGEM VEIO DO CEP/BUSCA (PRECISA DE FORWARD GEOCODING)
                    const cepOrigem = document.getElementById("cep-origem").value.replace(/\D/g, "");
                    const numeroOrigem = document.getElementById("numero-origem").value;
                    const geocodeQueryOrigem = `${enderecoOrigemCompleto}, N√∫mero ${numeroOrigem}, CEP ${cepOrigem}`;
                    
                    coordOrigem = await geocode(geocodeQueryOrigem);
                    console.log("[COORD SOURCE] Origem obtida via Forward Geocoding.");
                }

                // --- 2. Calcular Taxa Fixa ---
                let taxa = 0;
                if (tipoVeiculo === "50") taxa = 50;
                else if (tipoVeiculo === "15") {
                    if (cilindrada <= 160) taxa = 15;
                    else if (cilindrada <= 250) taxa = 25;
                    else if (cilindrada <= 499) taxa = 35;
                    else if (cilindrada <= 999) taxa = 50;
                    else taxa = 100;
                }

                // --- 3. Geocodificar Base e Destino (em paralelo) ---
                const cepDestino = document.getElementById("cep-destino").value.replace(/\D/g, "");
                const numeroDestino = document.getElementById("numero-destino").value;
                const geocodeQueryDestino = `${enderecoDestinoCompleto}, N√∫mero ${numeroDestino}, CEP ${cepDestino}`;
                
                const [coordBase, coordDestino] = await Promise.all([
                    geocode(enderecoBase),
                    geocode(geocodeQueryDestino),
                ]);
                
                console.log(`[COORD DEBUG] Base Coords: ${coordsString(coordBase)}`);
                console.log(`[COORD DEBUG] Origem Coords: ${coordsString(coordOrigem)}`);
                console.log(`[COORD DEBUG] Destino Coords: ${coordsString(coordDestino)}`);

                // --- 4. MONTAR PARES DE ROTA COM JITTER SELETIVO ---
                let baseToOrigem = [coordBase, coordOrigem];
                let origemToDestino = [coordOrigem, coordDestino];
                let destinoToBase = [coordDestino, coordBase];
                let jitterApplied = { 1: false, 2: false, 3: false };

                if (JSON.stringify(coordBase) === JSON.stringify(coordOrigem)) {
                    baseToOrigem = [coordBase, applyJitter(coordOrigem)];
                    jitterApplied[1] = true;
                }
                if (JSON.stringify(coordOrigem) === JSON.stringify(coordDestino)) {
                    origemToDestino = [coordOrigem, applyJitter(coordDestino)];
                    jitterApplied[2] = true;
                }
                if (JSON.stringify(coordDestino) === JSON.stringify(coordBase)) {
                    destinoToBase = [coordDestino, applyJitter(coordBase)];
                    jitterApplied[3] = true;
                }

                // --- 5. Calcular Rotas (em paralelo) ---
                const promiseDist1 = safeRota(baseToOrigem[0], baseToOrigem[1], jitterApplied[1]);
                const promiseDist2 = safeRota(origemToDestino[0], origemToDestino[1], jitterApplied[2]);
                const promiseDist3 = safeRota(destinoToBase[0], destinoToBase[1], jitterApplied[3]);

                const [res1, res2, res3] = await Promise.all([
                    promiseDist1,
                    promiseDist2,
                    promiseDist3,
                ]);
                
                const dist1 = res1.distance;
                const dist2 = res2.distance;
                const dist3 = res3.distance;
                
                const fallback1 = res1.fallback;
                const fallback2 = res2.fallback;
                const fallback3 = res3.fallback;

                // --- 6. Apresentar Resultado ---
                const distanciaTotalKm = dist1 + dist2 + dist3;
                const valorKm = distanciaTotalKm * 1.7; // R$ 1,70 por km
                valorTotal = valorKm + taxa;
                
                const detalhesMoto = tipoVeiculo === "15" ? 
                    ` (Cilindrada: ${document.getElementById("cilindrada-moto").value}cc)` : '';
                
                const notaFallback = "(Dist√¢ncia m√≠nima de 0.2 km for√ßada para evitar falha na rota)";
                const textoDist1 = `Base ‚Üí Origem: ${dist1.toFixed(2)} km${fallback1 ? ` ${notaFallback}` : ''}`;
                const textoDist2 = `Origem ‚Üí Destino: ${dist2.toFixed(2)} km${fallback2 ? ` ${notaFallback}` : ''}`;
                const textoDist3 = `Destino ‚Üí Base: ${dist3.toFixed(2)} km${fallback3 ? ` ${notaFallback}` : ''}`;
                
                document.getElementById("resultado").innerText =
                    `üìç Coordenadas Utilizadas:\n` +
                    `Base: ${coordsString(coordBase)}\n` +
                    `Origem: ${coordsString(coordOrigem)}\n` +
                    `Destino: ${coordsString(coordDestino)}\n\n` +
                    `Detalhes da Rota:\n` +
                    `${textoDist1}\n` +
                    `${textoDist2}\n` +
                    `${textoDist3}\n\n` +
                    `Dist√¢ncia Total (ida e volta): ${distanciaTotalKm.toFixed(2)} km\n` +
                    `Custo por KM (R$ 1,70/km): R$ ${valorKm.toFixed(2)}\n` +
                    `Taxa Fixa (Ve√≠culo: ${tipoVeiculo === '50' ? 'Carro' : 'Moto'}${detalhesMoto}): R$ ${taxa.toFixed(2)}\n` +
                    `\nüí∞ VALOR TOTAL ESTIMADO: R$ ${valorTotal.toFixed(2)}`;
                
                updateWhatsappButton(enderecoOrigemCompleto, enderecoDestinoCompleto, valorTotal);
                
            } catch (error) {
                console.error("Erro no c√°lculo:", error);
                mostrarMensagemErro(`‚ùå Erro: ${error.message}`); 
                document.getElementById("resultado").innerText = "‚ùå Erro no c√°lculo. Verifique os dados.";
                document.getElementById("whatsapp-solicitar-btn").setAttribute('disabled', 'true');
            }
        }

        function mostrarMensagemErro(msg) {
            const div = document.getElementById("mensagem-erro");
            div.style.display = "block";
            div.textContent = msg;
        }

        function limparMensagemErro() {
            const div = document.getElementById("mensagem-erro");
            div.style.display = "none";
            div.textContent = "";
        }

        function updateWhatsappButton(origem, destino, valor) {
            const btn = document.getElementById("whatsapp-solicitar-btn");
            const msg = encodeURIComponent(
                `Ol√°! Gostaria de solicitar um reboque.\n\n` +
                `üìç Origem: ${origem}\n` +
                `üèÅ Destino: ${destino}\n\n` +
                `üíµ Valor estimado: R$ ${valor.toFixed(2)}\n\n` +
                `Por favor, confirme a disponibilidade.`
            );
            btn.removeAttribute('disabled');
            btn.onclick = () => {
                window.open(`https://api.whatsapp.com/send?phone=${WHATSAPP_NUMBER}&text=${msg}`, '_blank');
            };
        }

        // === FLUXO DE BUSCA DE ENDERE√áO ===

        async function buscarOrigemCEP() {
            limparMensagemErro();
            const cep = document.getElementById("cep-origem").value.replace(/\D/g, "");
            const numero = document.getElementById("numero-origem").value;
            if (!cep || !numero) {
                 mostrarMensagemErro("Preencha CEP e N√∫mero para buscar o endere√ßo.");
                 return;
            }
            try {
                // Limpa coordenadas salvas (indicando que a origem √© agora via CEP)
                document.getElementById("coord-origem-lon").value = "";
                document.getElementById("coord-origem-lat").value = "";
                
                const end = await buscarEnderecoPorCEP(cep, numero);
                document.getElementById("origem").value = end;
            } catch (e) {
                mostrarMensagemErro(e.message);
                document.getElementById("origem").value = "";
            }
        }

        async function usarLocalizacaoAtual() {
            limparMensagemErro();
            document.getElementById("origem").value = "Buscando localiza√ß√£o...";

            if (!navigator.geolocation) {
                mostrarMensagemErro("Seu navegador n√£o suporta geolocaliza√ß√£o.");
                document.getElementById("origem").value = "";
                return;
            }

            try {
                const position = await new Promise((resolve, reject) => {
                    navigator.geolocation.getCurrentPosition(resolve, reject, {
                        enableHighAccuracy: true,
                        timeout: 10000,
                        maximumAge: 0
                    });
                });

                const lat = position.coords.latitude;
                const lon = position.coords.longitude;
                
                // 1. Tentar reverter as coordenadas para endere√ßo de texto
                const enderecoTexto = await reverseGeocode(lat, lon);
                
                // 2. Salvar as coordenadas reais nos campos hidden para usar no c√°lculo
                document.getElementById("coord-origem-lon").value = lon;
                document.getElementById("coord-origem-lat").value = lat;

                // 3. Limpar CEP/N√∫mero e popular campo de endere√ßo
                document.getElementById("cep-origem").value = "";
                document.getElementById("numero-origem").value = "";
                document.getElementById("origem").value = `(LOCALIZA√á√ÉO ATUAL) ${enderecoTexto}`;
                
            } catch (error) {
                let msg = "Erro ao obter localiza√ß√£o. Verifique as permiss√µes do navegador.";
                if (error.code === 1) {
                    msg = "Permiss√£o de geolocaliza√ß√£o negada pelo usu√°rio.";
                } else if (error.code === 3) {
                    msg = "Tempo limite excedido para obter localiza√ß√£o.";
                } else {
                    // Erro vindo do reverseGeocode (NetworkError ou Endere√ßo n√£o encontrado)
                    msg = `Falha na geolocaliza√ß√£o ou no reconhecimento do endere√ßo: ${error.message}`;
                }
                mostrarMensagemErro(`‚ùå ${msg}`);
                document.getElementById("origem").value = "";
                document.getElementById("coord-origem-lon").value = "";
                document.getElementById("coord-origem-lat").value = "";
            }
        }

        async function buscarDestinoCEP() {
            limparMensagemErro();
            const cep = document.getElementById("cep-destino").value.replace(/\D/g, "");
            const numero = document.getElementById("numero-destino").value;
            if (!cep || !numero) {
                 mostrarMensagemErro("Preencha CEP e N√∫mero do destino para buscar o endere√ßo.");
                 return;
            }
            try {
                const response = await buscarEnderecoPorCEP(cep, numero);
                document.getElementById("destino").value = response;
            } catch (e) {
                mostrarMensagemErro(e.message);
                document.getElementById("destino").value = "";
            }
        }

        // === SETUP INICIAL ===
        window.onload = function() {
            
            document.getElementById("btn-calcular").addEventListener("click", calcular);
            
            // Novos Listeners para os bot√µes de Origem
            document.getElementById("btn-buscar-origem-cep").addEventListener("click", buscarOrigemCEP);
            document.getElementById("btn-usar-localizacao").addEventListener("click", usarLocalizacaoAtual);

            // Listener para o bot√£o de Destino (mant√©m o nome da fun√ß√£o)
            document.getElementById("btn-buscar-destino").addEventListener("click", buscarDestinoCEP);

            document.getElementById("tipo").addEventListener("change", e => {
                const showMoto = e.target.value === "15";
                document.getElementById("detalhes-moto").style.display = showMoto ? "block" : "none";
                
                if (!showMoto) {
                    document.getElementById("marca-moto").value = "";
                    document.getElementById("modelo-moto").value = "";
                    document.getElementById("cilindrada-moto").value = "";
                }
            });
            
            document.getElementById("whatsapp-solicitar-btn").setAttribute('disabled', 'true');
        };
    </script>
</head>
<body>
    <main class="container">
        <h1 class="logo-placeholder">üöö Gbservice Reboque</h1>

        <div id="mensagem-erro" class="mensagem-erro" style="display: none;"></div>
        
        <!-- CAMPOS HIDDEN PARA SALVAR COORDENADAS DA GEOLOCALIZA√á√ÉO -->
        <input type="hidden" id="coord-origem-lon" value="" />
        <input type="hidden" id="coord-origem-lat" value="" />

        <section class="section endereco-section">
            <h2>Local do Ve√≠culo (Origem)</h2>
            <div class="form-group">
                <label for="cep-origem">CEP:</label>
                <input type="text" id="cep-origem" placeholder="Digite o CEP de onde o ve√≠culo est√°" maxlength="8" autocomplete="postal-code" />
            </div>
            <div class="form-group">
                <label for="numero-origem">N√∫mero (Se aplic√°vel):</label>
                <input type="number" class="number-label" id="numero-origem" placeholder="N√∫mero" autocomplete="address-level1" />
            </div>
            
            <div class="button-group">
                 <!-- Bot√£o de buscar CEP RENOMEADO -->
                <button id="btn-buscar-origem-cep" type="button">Buscar por CEP</button>
                <!-- NOVO BOT√ÉO DE GEOLOCALIZA√á√ÉO -->
                <button id="btn-usar-localizacao" type="button" style="background-color: #38a169;">Usar Localiza√ß√£o Atual</button>
            </div>
            
            <div class="form-group">
                <label for="origem">Endere√ßo completo (Gerado automaticamente):</label>
                <input disabled type="text" id="origem" placeholder="Endere√ßo gerado ap√≥s busca ou localiza√ß√£o" autocomplete="street-address" />
            </div>
        </section>

        <section class="section destino-section">
            <h2>Destino do Reboque</h2>
            <div class="form-group">
                <label for="cep-destino">CEP:</label>
                <input type="text" id="cep-destino" placeholder="Digite o CEP da rua de destino" maxlength="8" autocomplete="postal-code" />
            </div>
            <div class="form-group">
                <label for="numero-destino">N√∫mero:</label>
                <input type="number" class="number-label" id="numero-destino" placeholder="N√∫mero" autocomplete="address-level1" />
            </div>
            
            <button id="btn-buscar-destino" type="button" class="button-buscar">Buscar Endere√ßo de Destino</button>
            
            <div class="form-group">
                <label for="destino">Endere√ßo de destino completo:</label>
                <input disabled type="text" id="destino" placeholder="Endere√ßo gerado automaticamente" autocomplete="address-line1" />
            </div>
            <div class="form-group">
                <label for="tipo">Tipo de Ve√≠culo:</label>
                <select id="tipo" aria-label="Tipo de ve√≠culo">
                    <option value="" disabled selected>Selecione</option>
                    <option value="50">Carro</option>
                    <option value="15">Moto</option>
                </select>
            </div>
            <div id="detalhes-moto" style="display: none;">
                <div class="form-group">
                    <label for="marca-moto">Marca:</label>
                    <input type="text" id="marca-moto" placeholder="Ex.: Honda" />
                </div>
                <div class="form-group">
                    <label for="modelo-moto">Modelo:</label>
                    <input type="text" id="modelo-moto" placeholder="Ex.: CG Titan" />
                </div>
                <div class="form-group">
                    <label for="cilindrada-moto">Cilindrada:</label>
                    <input type="number" class="number-label" id="cilindrada-moto" placeholder="Ex.: 160" />
                </div>
            </div>
        </section>

        <section class="section acao-section">
            <button id="btn-calcular" type="button">Calcular valor</button>
        </section>

        <section class="section resultado-section" aria-live="polite" aria-atomic="true">
            <div id="resultado">Preencha todos os campos e clique em CALCULAR.</div>
        </section>

        <section class="section whatsapp-section">
            <button id="whatsapp-solicitar-btn" class="whatsapp-button" disabled>Solicitar reboque via WhatsApp</button>
        </section>
        <footer class="footer">
            <p>Desenvolvido por <strong>Natanael Costa</strong></p>
        </footer>
    </main>
</body>
</html>
